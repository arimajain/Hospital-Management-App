{% extends "base.html" %}
{% block content %}
<h2>Patient history: {{ patient.full_name }}</h2>

<div class="card mb-3 p-3">
  <p><strong>Phone:</strong> {{ patient.phone or '-' }} &nbsp; <strong>Email:</strong> {{ patient.email or '-' }}</p>
  <p><strong>Blood group:</strong> {{ patient.blood_group or '-' }} &nbsp; <strong>Address:</strong> {{ patient.address or '-' }}</p>
</div>

<h4>Appointments & Treatments</h4>
<table class="table table-sm">
  <thead><tr><th>Date</th><th>Time</th><th>Status</th><th>Diagnosis</th><th>Prescription</th><th>Notes</th><th>Action</th></tr></thead>
  <tbody>
    {% for r in records %}
      <tr>
        <td>{{ r.date }}</td>
        <td>{{ r.time }}</td>
        <td>{{ r.status }}</td>
        <td>{{ r.diagnosis or '-' }}</td>
        <td>{{ r.prescription or '-' }}</td>
        <td>{{ r.notes or '-' }}</td>
        <td>
          {% if r.doctor_id == current_doctor_id %}
            <a class="btn btn-sm btn-outline-primary" href="{{ url_for('doctor_complete_appointment', appointment_id=r.appt_id) }}">Edit</a>
          {% else %}
            <span class="text-muted">-</span>
          {% endif %}
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<div class="text-end">
  <a href="{{ url_for('doctor_dashboard') }}" class="btn btn-secondary">Back to Dashboard</a>
  
</div>
{% endblock %}
